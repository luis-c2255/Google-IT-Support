# Week 3: AAA Security

## Authentication

### Authentication Best Practices

- **Identification** is the idea of describing an entity uniquely.
- **Authentication** is the process of proving you are who you claim to be.
- **Authorization** pertains to the resources an identity has access to.

In the security world, these two concepts are distinguished from each other by the terms **"authn" (authentication)** and **"authz" (authorization)**.

Security should be thought of as *risk mitigation*.

A good password policy system would enforce *length requirements,* *character complexity*, and the *absence of dictionary words*.


### Multi-factor Authentication

- Username/password is often referred to as *single-factor authentication*.
- **Multi-factor authentication** is a system where users are authenticated by presenting multiple pieces of information or objects.
  1. Something you know
    - Password/PIN
  2. Something you have
    - ATM / Bank card
  3. Something you are
    - Biometric data

One-time password (OTP)
- RSA SecureID time-based token (TOTP) random seed generates an OTP

- Physical tokens
- Short-lived token
  - Commonly generated by physical tokens
- Time-based token (TOTP)
  - Operates by having a secret seed or randomly-generated value on the token that's registered with the authentication server.
- Counter-based tokens
  - More secure than time-based tokens for two reasons:
    1. The attacker would need to recover the seed value and the counter value
    2. The counter value is also incrementing when it's being used -- so a cloned token would only be useful for a short period of time before the counter value changes too much and the cloned token becomes unsynchronized from the real token and the server.

#### U2F
- **Universal 2nd Factor (U2F)** developed by Google, Yubico, and NXP Semiconductors. 
- It incorporates a challenge-response mechanism, along with public key cryptography to implement a more secure and more convenient second-factor authentication solution. 
- U2F tokens are referred to as *security keys* and are available from a range of manufacturers.
- U2F authentication support is built into Chrome and Opera browsers, with native Firefox support on the way.

#### Biometric Authentication

**Biometric authentication** is the process of using unique physiological characteristics of an individual to identify them.

Biometric data should never be stored directly. (It should be run through a hashing algorithm, and the hash is what's stored, not the data.)

**Windows Hello**


### Certificates

Recall that certificates are public keys that are signed by a certificate authority (CA) as a sign of trust.

- In addition to TLS server certificates, there can also be client certificates.
  - These operate very similarly to server certificates but are presented by clients, and allow servers to authenticate and verify clients.
  - It's not uncommon for VPN systems or enterprise WiFi setups to use client certificates for authentication.
- To issue client certificates, an organization must set up and maintain CA infrastructure to issue and sign certificates.
  - Part of authentication also involves the client authenticating the server, providing mutual authentication.
  - This is good, since the client can verify it's talking to the real server, and not an imposter.

Certificates have two dates that need to be verified:
  1. Not valid before;
  2. Not valid after


### LDAP

- Recall that **Lightweight Directory Access Protocol (LDAP)** is an open, industry-standard protocol for accessing and maintaining directory services.
  - Directory services, in this context, refers to something similar to a phone or email directory.
  - It's most commonly used as a backend for the authentication of accounts.
- LDAP uses a tree structure called a **Data Information Tree**, meaning objects will have one parent, and can have one or more children that belong to the parent object.
  - Recall these parents are known as **organizational units (OUs)**
  - Since it's possible for entries in the directory to share attributes, there must be a unique identifier for each entry -- we call this **Distinguished Name (DN)**.
  - *You can think of a DN as a full path to a file, as opposed to a file name.*
    - *Multiple files can have the same file name; but the fully qualified path would describe one unique file.*

#### Common LDAP server operations
- Bind
  - How clients authenticate to the server
- StartTLS
  - Permits a client to communicate using LDAP v3 over TLS
- Search
  - For performing look-ups and retrieval of records
- Add/delete/modify
  - Various operations to write data to the directory
- Unbind
  - Closes the connection to the LDAP server


### RADIUS

- **Remote Authentication Dial-In User Service (RADIUS)** is a protocol that provides AAA services for users on a network.
- A common protocol, used to manage access to internal networks, WiFi networks, email services, and VPN services.
- Originally used for remote dial-up users, it evolved to carry numerous standard authentication protocols like **Extensible Authentication Protocol (EAP)**.
- RADIUS servers can verify user authentication info stored in a flat file, or can ping into external sources like SQL databases, LDAP, Kerberos, or Active Directory.
- A RADIUS server replies with one of three messages:
  1. Access reject
  2. Access challenge
  3. Access accept
- Clients don't actually interact with the RADIUS server directly -- they relay authentications via the Network Access Server.


### Kerberos

- **Kerberos** is a network authentication protocol that uses "tickets" to allow entities to prove their identity over potentially insecure channels to provide mutual authentication.
- It uses symmetric encryption
- Supports AES encryption and implements checksums for confidentiality
- Windows domains from Windows 2000 onward use Kerberos
- "Tickets" are a token to prove your identity

#### How the Kerberos protocol operates

[ notes ]


### TACACS+

- **Terminal Access Controller Access-Control System Plus (TACACS+)** is a Cisco-developed AAA protocol released as an open standard in 1993.
- TACACS+ is primarily used for device administration, authentication, authorization, and accounting.
  - As opposed to RADIUS, *which is mostly used for network access AAA*.
- TACACS+ is mainly used as an authentication system for network infrastructure devices -- which tend to be high-value targets for attackers.


### Single Sign-On

- **Single sign-on (SSO)** is an authentication concept that allows users to authenticate once to be granted access to a lot of different services and applications.
  - SSO is accomplished by authenticating to a central authorization server, like an LDAP server. 
  - This then provides a cookie -- or token -- that can be used to get access to applications configured to use SSO.
- Kerberos is a good example of an SSO authentication service.
- Another example of an SSO system is the OpenID decentralized authentication system.

An attacker that compromises an account has a lot more access under an SSO scheme.


## Authorization

### Authorization and Access Control Methods

Recall that **authorization** pertains to describing what the user account has access to, or doesn't have access to.

One very popular open standard for authorization and access delegation is **OAauth**, used by companies like Google, Facebook, and Microsoft.


### Access Control

- **OAuth** is an open standard that allows users to grant third-party websites and applications access to their information without sharing account credentials.
- It's a form of access delegation, as it's delegated to a third-party.

- It starts by prompting the user to confirm that they agree to the third-party access to their account
- Once confirmed, the identity provider will supply the third-party with a token
- This token can be used by the third-party to access data or services offered by the identity provider directly on behalf of the user.

OAuth is commonly used to grant access to third-party applications, to APIs offered by large Internet companies like Google, Microsoft, and Facebook.

OAuth permissions can be used in phishing-style attacks to gain access to accounts, *without requiring credentials* to be compromised.

OAuth is specifically an authorization system; and OpenID is an authentication system. 

- RADIUS also allows you to authorize network access.
- You may want to permit some users to have WiFi and VPN access, while others may not need this
- When they authenticate to the RADIUS server, if the authentication succeeds, the RADIUS server returns configuration information to the network access server.


### Access Control List

- An **access control list (ACL)** is a way of defining permissions or authorizations for objects.
- The most common example is file system permissions.
  - A file system would have an ACL -- which is a table or database -- with a list of entries specifying access rights for individuals or groups for various objects on the file system (like folders, files, or programs)
- These individual access permissions per object are called *access control entries*, and they make up the ACL.
- Network ACLs are used for restricting and controlling access to hoster services running on hosts within your network.


## Accounting

### Tracking Usage and Access

- **Accounting** means keeping records of what resources and services your users accessed, or what they did when they were using your systems.
- A critical component of this is **auditing**, which involves reviewing these records to ensure that nothing is out of the ordinary.
- TACACS+ is a device access AAA system that manages who has access to your network devices and what they do on them.
